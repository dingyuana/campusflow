**《智慧校园多智能体系统开发实战》教学大纲**

---

## 一、课程基本信息

| 项目 | 内容 |
|------|------|
| **课程名称** | 智慧校园多智能体系统开发实战 |
| **英文名称** | Practical Development of Multi-Agent Systems for Smart Campus |
| **课程代码** | AI-MAS-2025 |
| **学时/学分** | 60学时（40理论+20实验）/ 3学分 |
| **适用对象** | 计算机科学与技术、软件工程、人工智能等专业本科高年级学生及研究生 |
| **先修课程** | Python程序设计、数据库原理、机器学习基础 |
| **项目载体** | "校园新生报到助手"全栈智能体应用 |

---

## 二、课程简介与定位

本课程以**智慧校园新生报到场景**为业务载体，基于LangGraph框架开展多智能体系统（MAS）的端到端开发实训。课程采用"做中学"的沉浸式项目制教学模式，覆盖从工程化架构设计、知识获取（RAG+知识图谱）、智能体协作（ReAct/Supervisor）、人机交互（HITL）到生产级部署（CI/CD）的完整技术链路。

通过16个系统性实验模块（Day 0-Day 15），学生将掌握现代企业级AI应用开发的核心范式：状态管理、容错设计、安全合规、并发优化与DevOps实践，最终交付可运行的开源智能体产品。

---

## 三、教学目标

### 1. 知识目标
- 掌握多智能体系统（MAS）的架构模式（主从编排、动态路由、分工协作）
- 理解大模型应用开发的核心技术栈：RAG、ReAct、StateGraph、MCP协议
- 熟悉分布式系统中的状态一致性、记忆持久化与并发控制机制
- 掌握工程化开发规范（Git Flow、容器化、CI/CD）

### 2. 能力目标
- **架构设计能力**：能够针对复杂业务场景设计StateGraph工作流与Agent协作拓扑
- **知识工程能力**：具备非结构化数据（向量检索）与结构化数据（知识图谱）的融合检索设计能力
- **系统实现能力**：熟练运用LangGraph实现记忆系统、人机交互、安全防护等生产级功能
- **工程交付能力**：掌握Docker容器化、云端部署与自动化测试，完成从代码到产品的闭环

### 3. 素质目标
- 培养复杂工程问题的拆解与模块化思维能力
- 建立AI安全与伦理意识（PII检测、内容过滤、权限控制）
- 形成团队协作与规范编码的职业素养（Code Review、文档编写）

---

## 四、教学内容与学时安排

### 模块一：工程基础与项目启动（8学时）
**核心内容**：  
- 多智能体系统（MAS）设计模式与分布式状态管理理论  
- 工程化规范：Git Flow工作流、Conventional Commits、分层项目架构（api/agents/db/utils）  
- 开发环境容器化：Docker多阶段构建、docker-compose本地开发栈  
- 云原生基础设施：Supabase云数据库（PostgreSQL）配置与Python接入  

**实验重点**：  
标准化项目目录初始化、云端数据库连接测试、Docker镜像构建与运行  

### 模块二：知识获取与表示（8学时）
**核心内容**：  
- **RAG系统**：文档加载（PyPDFLoader）、语义切分策略（chunk_size/overlap优化）、Chroma向量库、混合检索（语义+关键词）  
- **知识图谱**：Neo4j图数据库建模（节点/关系/属性）、智慧校园领域本体设计（学生-教师-实验室-课程）  
- **跨模态检索**：Text-to-Cypher安全实现（Cypher注入防护）、向量库与图数据库的联邦查询  

**实验重点**：  
《校园报到手册》RAG系统构建、校园知识图谱可视化、多跳关系查询（如"查询导师实验室所有学生"）  

### 模块三：智能体核心架构（12学时）
**核心内容**：  
- **基础Agent**：ReAct范式实现、Tool Calling机制、工具描述工程  
- **工作流编排**：StateGraph状态机设计、条件边（Conditional Edges）、持久化检查点（Checkpoint）  
- **安全与合规**：四层中间件体系（预算控制/消息截断/敏感词过滤/PII检测）  
- **人机协作**：HITL（Human-in-the-loop）中断恢复机制、审核工作台设计  

**实验重点**：  
新生报到流程StateGraph实现、敏感信息脱敏处理、人工审核流程编码  

### 模块四：记忆与上下文管理（8学时）
**核心内容**：  
- **记忆分层**：短期记忆（Thread级Checkpointer）与长期记忆（User级Store）  
- **上下文工程**：State/Store/Runtime三层上下文体系、Configurable动态配置、多租户隔离  
- **MCP协议**：Model Context Protocol服务器开发、封装校务系统API（教务/财务/宿管）  

**实验重点**：  
学生画像自动构建、跨会话记忆保持、MCP Server对接与LangGraph桥接  

### 模块五：高级架构模式（8学时）
**核心内容**：  
- **监督者模式**：Supervisor多Agent协同（Tool-calling vs langgraph-supervisor）、智能路由与负载均衡  
- **并行计算**：节点并行（Send API）、@task异步装饰器、Map-Reduce批量处理  
- **实时信息**：网络搜索集成（Tavily/DashScope/DDGS）、搜索与RAG的融合策略、时效性判断  

**实验重点**：  
Supervisor架构重构报到流程、批量生成欢迎信（Map-Reduce）、实时天气查询集成  

### 模块六：DevOps与产品发布（8学时）
**核心内容**：  
- **自主智能体**：Deep Agents规划-执行-反思循环、端到端自动化流程、安全沙箱  
- **CI/CD实践**：GitHub Actions工作流（测试/构建/部署）、自动化测试（pytest）、Hugging Face Spaces云部署  
- **前端交互**：Gradio流式聊天界面、多模态输入（OCR）、进度可视化  

**实验重点**：  
GitHub Actions配置、Gradio应用容器化、生产环境健康检查与监控  

---

## 五、教学方法与手段

1. **项目驱动式教学**：以"新生报到助手"为唯一贯穿项目，各模块技术点均映射到真实业务需求（咨询→办理→审核→通知）
2. **代码筑基（Code-First）**：理论讲解与实时代码演示占比1:1，提供"沙盒模板代码"降低环境门槛
3. **分层考核**：每日量化评分（功能实现+代码质量）+ 模块集成测试 + 最终产品路演
4. **云原生实训**：全部采用云端基础设施（Supabase/Neo4j Aura/Hugging Face），避免本地环境配置消耗
5. **协作开发**：强制使用Git Flow，通过Pull Request进行代码审查，模拟开源社区协作模式

---

## 六、考核方式与评价标准

### 成绩构成
| 考核维度 | 权重 | 评价方式 |
|---------|------|---------|
| 日常实验 | 40% | 16个Day的量化评分（功能完成度+代码规范+文档） |
| 模块项目 | 30% | 5个模块集成检查点（RAG系统/知识图谱/Supervisor架构等） |
| 期末交付 | 20% | 可运行的开源产品（GitHub仓库+在线Demo+架构文档） |
| 答辩路演 | 10% | 15分钟产品演示（技术亮点+业务价值） |

### 评分细则（参考Day级标准）
- **优秀（90-100）**：完成功能+有创新扩展（如自定义安全策略/优化检索算法），代码符合PEP8，文档完善
- **良好（80-89）**：完成核心功能，架构合理，通过所有测试用例
- **中等（70-79）**：基本完成主要功能，存在轻微代码缺陷但不影响运行
- **及格（60-69）**：能运行基础Demo，但缺少部分模块（如缺少安全防护或记忆功能）
- **不及格（<60）**：无法完成基础Agent构建或存在抄袭行为

---

## 七、课程资源与条件

### 必需环境
- **开发环境**：Python 3.11+、VS Code/PyCharm、Git
- **云端服务**：Supabase（PostgreSQL）、Neo4j Aura（图数据库）、Hugging Face账号
- **API密钥**：OpenAI API（或兼容代理）、Tavily API（搜索）、DashScope（可选）

### 推荐工具库
- **核心框架**：LangGraph 0.2+、LangChain 0.3+
- **向量库**：ChromaDB、Sentence-Transformers（BGE-m3）
- **部署**：Docker、GitHub Actions、Gradio 5.0+

### 教学资料
- **代码模板**：每日Starter Code与Solution分支
- **测试数据集**：《校园报到手册.pdf》、仿真学生数据（JSON/CSV）
- **规范文档**：Conventional Commits规范、Cypher安全编码指南

---

## 八、教学进度计划表

| 天数 | 教学模块 | 核心知识点 | 交付物 | 关键技术栈 |
|------|---------|-----------|--------|-----------|
| **Day 0** | 工程化启动 | MAS架构、Git Flow、Docker、Supabase | 项目模板+云端连接测试 | Docker, Supabase |
| **Day 1** | 基础Agent | ReAct范式、Tool Calling | 校园咨询Agent | LangGraph Prebuilt |
| **Day 2** | RAG系统 | 语义切分、Chroma、混合检索 | 报到手册问答系统 | LangChain, BGE-m3 |
| **Day 3** | 知识图谱 | Neo4j建模、Text-to-Cypher | 校园关系图谱+安全查询 | Neo4j, Cypher |
| **Day 4** | 工作流编排 | StateGraph、条件边、Checkpoint | 报到流程状态机 | StateGraph |
| **Day 5** | 中间件体系 | 预算/截断/敏感词/PII四层防护 | 内容安全过滤层 | Middleware Chain |
| **Day 6** | 人机交互 | HITL、中断恢复、审核台 | 人工确认流程 | Interrupt API |
| **Day 7** | 记忆系统 | 短期/长期记忆、学生画像 | 跨会话身份识别 | MemorySaver, Store |
| **Day 8** | 上下文工程 | State/Store/Runtime分层 | 多租户配置管理 | RunnableConfig |
| **Day 9** | MCP协议 | MCP Server开发、校务系统集成 | 教务/财务/宿管工具 | Model Context Protocol |
| **Day 10** | CI/CD | GitHub Actions、HF Spaces部署 | 自动化流水线+线上Demo | Docker, Actions |
| **Day 11** | 监督者模式 | Supervisor、动态路由 | 多Agent协同架构 | langgraph-supervisor |
| **Day 12** | 并行计算 | Send API、@task、Map-Reduce | 批量处理优化 | Asyncio, Task |
| **Day 13** | 网络搜索 | Tavily/DDGS集成、搜索决策 | 实时信息增强 | Search API |
| **Day 14** | 深度智能 | Deep Agents、自主规划 | 端到端自动报到 | Agentic AI |
| **Day 15** | 产品发布 | Gradio流式UI、多模态、监控 | 生产级Web应用 | Gradio, SSE |

---

## 九、特色与创新点

1. **全栈真实性**：不同于孤立算法实验，本课程要求学生交付包含安全防护、人机协作、监控告警的**生产就绪（Production-Ready）**系统
2. **架构演进可视化**：从Day 1的单体ReAct Agent到Day 11的Supervisor多Agent架构，清晰展现系统复杂度演进路径
3. **云原生实训**：全程使用托管服务（Supabase/Neo4j Aura/HF Spaces），聚焦业务逻辑而非运维，培养现代云开发思维
4. **安全内建**：将PII检测、Cypher注入防护等安全左移实践融入日常开发，而非事后补丁

---

**编制说明**：本大纲基于LangGraph最新特性（0.2.x版本）设计，可根据实际教学周数调整为16周（每周4学时）或3周集中实训（每天约6-7学时）。建议前置《Python高级编程》与《数据库系统》课程。

**版本日期**：2026-01-31